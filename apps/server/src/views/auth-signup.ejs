<h1>Sign Up</h1>

<div id="error-message" class="error" style="display: none;"></div>

<form id="signup-form">
    <label for="name">Name *</label>
    <input type="text" id="name" name="name" required>

    <label for="email">Email *</label>
    <input type="email" id="email" name="email" required>

    <label for="password">Password *</label>
    <input type="password" id="password" name="password" required minlength="8">

    <button type="submit" class="btn" style="margin-top: 20px;">Sign Up</button>
</form>

<p style="margin-top: 20px;">Already have an account? <a href="/auth/login">Login</a></p>

<script>
document.getElementById('signup-form').addEventListener('submit', async (e) => {
    e.preventDefault()

    const name = document.getElementById('name').value
    const email = document.getElementById('email').value
    const password = document.getElementById('password').value
    const errorDiv = document.getElementById('error-message')

    try {
        const response = await fetch('/api/auth/sign-up/email', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ name, email, password }),
            credentials: 'include'
        })

        if (response.ok) {
            window.location.href = '/'
        } else {
            const data = await response.json()
            errorDiv.textContent = data.error || 'Sign up failed'
            errorDiv.style.display = 'block'
        }
    } catch (error) {
        errorDiv.textContent = 'Sign up failed. Please try again.'
        errorDiv.style.display = 'block'
    }
})
</script>

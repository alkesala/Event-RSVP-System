<h1>Login</h1>

<div id="error-message" class="error" style="display: none;"></div>

<form id="login-form">
    <label for="email">Email *</label>
    <input type="email" id="email" name="email" required>

    <label for="password">Password *</label>
    <input type="password" id="password" name="password" required>

    <button type="submit" class="btn" style="margin-top: 20px;">Login</button>
</form>

<p style="margin-top: 20px;">Don't have an account? <a href="/auth/signup">Sign up</a></p>

<script>
document.getElementById('login-form').addEventListener('submit', async (e) => {
    e.preventDefault()

    const email = document.getElementById('email').value
    const password = document.getElementById('password').value
    const errorDiv = document.getElementById('error-message')

    try {
        const response = await fetch('/api/auth/sign-in/email', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password }),
            credentials: 'include'
        })

        if (response.ok) {
            window.location.href = '/'
        } else {
            const data = await response.json()
            errorDiv.textContent = data.error || 'Invalid email or password'
            errorDiv.style.display = 'block'
        }
    } catch (error) {
        errorDiv.textContent = 'Login failed. Please try again.'
        errorDiv.style.display = 'block'
    }
})
</script>
